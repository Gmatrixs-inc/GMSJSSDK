<html>
  <head>
    <meta charset="UTF-8" />
    <title>GMS Test Dapp</title>
    <link rel="icon" type="image/svg" href="metamask-fox.svg" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.14.1/css/mdb.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="index.css" type="text/css" />
  </head>

  <body>
    <main class="container-fluid">
      <header>
        <div id="logo-container">
          <h1 id="logo-text" class="text-center">
            GMS Test Dapp
          </h1>

          <img id="mm-logo" src="metamask-fox.svg" />
        </div>
      </header>

      <section>
        <div class="row d-flex justify-content-center">
          <div class="col-xl-4 col-lg-6 col-md-12 col-sm-12 col-12">
            <div class="card">
              <div class="card-body">
                <h4 class="card-title">
                  Basic Actions
                </h4>

                <button
                  class="btn btn-primary btn-lg btn-block mb-3"
                  id="gmsConnectButton"
                >
                    gmsConnect
                </button>

                  <button
                          class="btn btn-primary btn-lg btn-block mb-3"
                          id="gmsGetAccounts"
                  >
                      gms_Get_Accounts
                  </button>

                  <button
                          class="btn btn-primary btn-lg btn-block mb-3"
                          id="gmsLogin"
                  >
                      gms_Login
                  </button>

                  <button
                          class="btn btn-primary btn-lg btn-block mb-3"
                          id="gmsLoginVerify"
                  >
                      gms_Login_Verify
                  </button>

                  <button
                          class="btn btn-primary btn-lg btn-block mb-3"
                          id="gmsGetBalance"
                  >
                      gmsGetBalance
                  </button>

                  <button
                          class="btn btn-primary btn-lg btn-block mb-3"
                          id="gmsTransaction"
                  >
                      gms_Transaction_ETH
                  </button>

              </div>
            </div>
          </div>
        </div>
      </section>

        <!-- <section>
            <div class="row d-flex justify-content-center">
                <div class="col-xl-4 col-lg-6 col-md-12 col-sm-12 col-12">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title">
                                Permissions Actions
                            </h4>

                            <button
                                    class="btn btn-primary btn-lg btn-block mb-3"
                                    id="requestPermissions"
                            >
                                Request Permissions
                            </button>

                            <button
                                    class="btn btn-primary btn-lg btn-block mb-3"
                                    id="getPermissions"
                            >
                                Get Permissions
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>-->

        <section>
            <div class="row d-flex justify-content-center">
                <div class="col-xl-4 col-lg-6 col-md-12 col-sm-12 col-12">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title">
                                ERC20 Actions
                            </h4>

                            <button
                                    class="btn btn-primary btn-lg btn-block mb-3"
                                    id="gmsApproveErc20"
                            >
                                gms_Approve_Erc20
                            </button>


                            <button
                                    class="btn btn-primary btn-lg btn-block mb-3"
                                    id="gmsGetErc20Balance"
                            >
                                gms_Get_Erc20_Balance
                            </button>

                            <button
                                    class="btn btn-primary btn-lg btn-block mb-3"
                                    id="gmsTransferErc20"
                            >
                                gms_Transfer_Erc20
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

      <section>
        <div class="row d-flex justify-content-center">
          <div class="col-xl-4 col-lg-6 col-md-12 col-sm-12 col-12">
            <div class="card">
              <div class="card-body">
                <h4 class="card-title">
                    ERC721 Actions
                </h4>

                  <button
                          class="btn btn-primary btn-lg btn-block mb-3"
                          id="gmsApproveErc721"
                  >
                      gms_Approve_Erc721
                  </button>


                  <button
                          class="btn btn-primary btn-lg btn-block mb-3"
                          id="gmsGetErc721Balance"
                  >
                      gms_Get_Erc721_Counts
                  </button>

                  <button
                          class="btn btn-primary btn-lg btn-block mb-3"
                          id="gmsTransferErc721"
                  >
                      gms_Transfer_Erc721
                  </button>
              </div>
            </div>
          </div>
        </div>
      </section>

    </main>

    <script src="bundle.js"></script>
   <script>
       var appid='n4uWXNHoAf1vtlCT';
       var User={
           from:"",
           sign:"",
           to:"0xeB9ce7D902342013E0D18cA132785bC7ABE61D2A"
       }

       document.getElementById('gmsConnectButton').onclick=function (){
           console.log("gmsConnectButton")
           GMSSDK.connect().then((res)=>{
               console.log(res)
           }).catch((err)=>console.log(err));;
       };

       document.getElementById('gmsGetAccounts').onclick=function (){
           console.log("gmsConnectButton")
           GMSSDK.getAccount().then((res)=>{
               User.from=res[0]
               console.log(res)
           }).catch((err)=>console.log(err));
       };

       document.getElementById("gmsLogin").onclick=function (){
           console.log(User)
           if(User.from.length==0){
             return
           }
           GMSSDK.getPersonalSign(User.from,"your message","your pwd").then((res)=>{
               console.log(res)
               User.sign=res
           }).catch((err)=>console.log(err))
       }

       document.getElementById("gmsLoginVerify").onclick=function (){
           console.log(User)
           if(User.from.length==0){
               return
           }

           if(User.sign.length==0){
               return
           }
           GMSSDK.getPersonalVerify("your message",User.sign).then((res)=>{
               console.log(res)
               if (res === User.from) {
                   console.log(`Successfully ecRecovered signer as ${res}`);
               }else{
                   `Failed to verify signer when comparing ${res} to ${User.from}`
               }
           }).catch((err)=>console.log(err))
       }

       document.getElementById("gmsTransaction").onclick=function (){
           console.log(User)
           if(User.from.length==0){
               return
           }

           if(User.to.length==0){
               return
           }
           let amount=GMSSDK.parseUnits("1.0",18)._hex;
           GMSSDK.transaction("your orderid",User.from,User.to,amount).then((res)=>{
               console.log(res)
           }).catch((err)=>{
               console.log(err)}
           )
       }

       document.getElementById("gmsGetBalance").onclick=function (){
           console.log(User)
           if(User.from.length==0){
               return
           }

           GMSSDK.getBalance(User.from).then((res)=>{
               console.log(GMSSDK.formatUnits(res,18))
           }).catch((err)=>{
               console.log(err)}
           )
       }

       //erc20 start
       document.getElementById("gmsApproveErc20").onclick=function (){
           GMSSDK.approveErc20Tokens(User.from,120000000).then((res)=>{
               console.log(res)
           }).catch((err)=>{
               console.log(err)}
           )
       }

       document.getElementById("gmsGetErc20Balance").onclick=function (){
           if(User.from.length==0){
               return
           }

           GMSSDK.getErc20Balance(User.from).then((res)=>{
               console.log(GMSSDK.parseUnits(res,18))
           }).catch((err)=>{
               console.log(err)}
           )
       }

       document.getElementById("gmsTransferErc20").onclick=function (){
           let amount=3
           GMSSDK.transferErc20Tokens("your orderid",User.from,User.to,amount).then((res)=>{
               console.log(res)
           }).catch((err)=>{
               console.log(err)}
           )
       }

       //Erc20 end

       //erc721 start
       document.getElementById("gmsApproveErc721").onclick=function (){
           if(User.from.length==0){
               return
           }

           GMSSDK.approveErc721Tokens(User.from,1000).then((res)=>{
               console.log(GMSSDK.parseUnits(res,"ether"))
           }).catch((err)=>{
               console.log(err)}
           )
       }

       document.getElementById("gmsGetErc721Balance").onclick=function (){
           if(User.from.length==0){
               return
           }

           GMSSDK.getErc721Balance(User.from).then((res)=>{
               console.log(res)
           }).catch((err)=>{
               console.log(err)}
           )
       }

       document.getElementById("gmsTransferErc721").onclick=function (){
           let tokenid="100"
           GMSSDK.transferErc721Tokens("your orderid",User.from,User.to,tokenid,"your callback url").then((res)=>{
               console.log(res)
           }).catch((err)=>{
               console.log(err)}
           )
       }
       //erc721 end

       //Permissions start
       document.getElementById("requestPermissions").onclick=function (){
           GMSSDK.requestPermissions(User.from).then((permissionsArray)=>{
               console.log(permissionsArray)
               console.log(GMSSDK.getPermissionsDisplayString(permissionsArray))
           }).catch((err)=>{
               console.log(err)}
           )
       }
       document.getElementById("getPermissions").onclick=function (){
           GMSSDK.getPermissions().then((permissionsArray)=>{
               console.log(permissionsArray)
               console.log(GMSSDK.getPermissionsDisplayString(permissionsArray))
           }).catch((err)=>{
               console.log(err)}
           )
       }

       //Permissions end

       function init(){
           // your appid
           GMSSDK.init(appid,1)
       }

       window.addEventListener('DOMContentLoaded', init);

   </script>
  </body>
</html>
